<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:local="clr-namespace:jeesi"
             x:Class="jeesi.TeamManagementPage"
             Title="Team Management">

    <ContentPage.Resources>
        <ResourceDictionary>
            <local:NullToBooleanConverter x:Key="NullToBooleanConverter" />
        </ResourceDictionary>
    </ContentPage.Resources>

    <VerticalStackLayout Spacing="20" Padding="20">
        <!-- Joukkueen lisääminen -->
        <Entry x:Name="TeamNameEntry" 
               Placeholder="Syötä joukkueen nimi" 
               Completed="OnTeamNameEntryCompleted"  />
        <Button Text="Lisää joukkue" 
                Clicked="OnAddTeamClicked" />

        <Label Text="Lisää pelaajia klikkaamalla joukkuetta johon pelaaja lisätään"/>

        <!-- Näytä joukkueet -->
        <Label Text="Joukkueet:" FontAttributes="Bold"/>
        <ListView x:Name="TeamsListView" 
                  ItemsSource="{Binding Teams}"
                  SelectionMode="Single"
                  SelectedItem="{Binding SelectedTeam, Mode=TwoWay}">
            <ListView.ItemTemplate>
                <DataTemplate>
                    <TextCell Text="{Binding TeamName}" />
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>
            

        <!-- Pelaajien lisääminen -->
        <Frame BorderColor="Gray" Padding="10" CornerRadius="5"
               IsVisible="{Binding SelectedTeam, Converter={StaticResource NullToBooleanConverter}}">
            <VerticalStackLayout>
                <Label Text="Lisää pelaaja valittuun joukkueeseen:" />
                <Entry x:Name="PlayerFirstNameEntry" 
                       Placeholder="Etunimi" 
                       Completed="OnPlayerEntryCompleted" />
                <Entry x:Name="PlayerLastNameEntry" 
                       Placeholder="Sukunimi" 
                       Completed="OnPlayerEntryCompleted" />
                <Entry x:Name="PlayerNumberEntry" 
                       Placeholder="Syötä pelaajan pelinumero" 
                       Keyboard="Numeric" 
                       Completed="OnPlayerEntryCompleted" />
                <Button Text="Lisää pelaaja joukkueeseen" 
                        Clicked="OnAddPlayerClicked"  />
            </VerticalStackLayout>
        </Frame>

        <!-- Pelaajien lista valitussa joukkueessa -->
        <Label Text="Pelaajat valitussa joukkueessa:"/>
        <ListView x:Name="PlayersListView"
          ItemsSource="{Binding SelectedTeam.Players}"
          SelectedItem="{Binding SelectedPlayer, Mode=TwoWay}">
            <ListView.ItemTemplate>
                <DataTemplate>
                    <ViewCell>
                        <StackLayout Orientation="Horizontal" Spacing="10">
                            <Label Text="{Binding PlayerNumber}" FontAttributes="Bold" />
                            <Label Text="{Binding FirstName}" />
                            <Label Text="{Binding LastName}" />
                        </StackLayout>
                    </ViewCell>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>

        <!-- Pelaajan poistaminen valitusta joukkueessa -->
        <Button Text="Poista valittu pelaaja"
        IsEnabled="{Binding SelectedPlayer, Converter={StaticResource NullToBooleanConverter}}"
        Clicked="OnDeletePlayerClicked"
        BackgroundColor="Red"
        TextColor="White"
        HorizontalOptions="FillAndExpand">
            <Button.Shadow>
                <Shadow Brush="Black"
                        Opacity="0.5"
                        Offset="5,5"
                        Radius="10" />
            </Button.Shadow>
        </Button>

        <!-- Pejoukkueessa -->
        <Button Text="Poista valittu joukkue"
        IsEnabled="{Binding SelectedTeam, Converter={StaticResource NullToBooleanConverter}}"
        Clicked="OnDeleteTeamClicked"
        BackgroundColor="Red"
        TextColor="White"
        HorizontalOptions="FillAndExpand">
            <Button.Shadow>
                <Shadow Brush="Black"
                        Opacity="0.5"
                        Offset="5,5"
                        Radius="10" />
            </Button.Shadow>
        </Button>

        <!-- Pelaajien lista valitussa joukkueessa -->
        <Button Text="Sulje ikkuna"
                Clicked="OnCloseClicked"
                VerticalOptions="End" 
                HorizontalOptions="FillAndExpand">
            <Button.Shadow>
                <Shadow Brush="Black"
                        Opacity="0.5"
                        Offset="5,5"
                        Radius="10" />
            </Button.Shadow>
        </Button>
    </VerticalStackLayout>
</ContentPage>
